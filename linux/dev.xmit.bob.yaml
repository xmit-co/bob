app-id: dev.xmit.bob
runtime: org.freedesktop.Platform
runtime-version: "25.08"
sdk: org.freedesktop.Sdk
command: bob
finish-args:
  - --share=ipc
  - --socket=wayland
  - --socket=fallback-x11
  - --device=dri
  - --share=network
  - --filesystem=host
modules:
  - name: bob
    buildsystem: simple
    build-commands:
      - ./flutter/bin/flutter config --no-analytics
      - ./flutter/bin/flutter pub get
      - ./flutter/bin/flutter build linux --release
      - mkdir -p /app/bin
      - |
        if [ -d "build/linux/x64/release/bundle" ]; then
          cp -r build/linux/x64/release/bundle/* /app/bin/
        elif [ -d "build/linux/arm64/release/bundle" ]; then
          cp -r build/linux/arm64/release/bundle/* /app/bin/
        else
          echo "Error: Could not find release bundle"; exit 1
        fi
      - ln -s bob /app/bin/dev.xmit.bob
      - install -Dm644 linux/dev.xmit.bob.desktop /app/share/applications/dev.xmit.bob.desktop
      - install -Dm644 dist/app_icon_256.png /app/share/icons/hicolor/256x256/apps/dev.xmit.bob.png
      - install -Dm644 linux/dev.xmit.bob.metainfo.xml /app/share/metainfo/dev.xmit.bob.metainfo.xml
    sources:
      - type: dir
        path: ..
      - type: git
        url: https://github.com/flutter/flutter.git
        tag: 3.38.1
        dest: flutter
